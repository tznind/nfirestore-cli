
//------------------------------------------------------------------------------

//  <auto-generated>
//      This code was generated by:
//        TerminalGuiDesigner v1.1.0.0
//      You can make changes to this file and they will not be overwritten when saving.
//  </auto-generated>
// -----------------------------------------------------------------------------
namespace nfirestore_cli {
    using Google.Api.Gax;
    using Google.Cloud.Firestore;
    using Google.Cloud.Firestore.V1;
    using Terminal.Gui;
    
    
    public partial class MainWindow {
        private readonly Options options;

        public MainWindow(Options o) {
            InitializeComponent();
            this.options = o;
        }

        public override void OnLoaded()
        {
            base.OnLoaded();

            var emu = Environment.GetEnvironmentVariable("FIRESTORE_EMULATOR_HOST");

            try
            {
                var builder = new FirestoreDbBuilder
                {
                    ProjectId = options.Project,
                    EmulatorDetection = Google.Api.Gax.EmulatorDetection.EmulatorOnly
                };

                var db = builder.Build();
            }
            catch (Exception ex)
            {
                MessageBox.ErrorQuery("Error Loading", $"{ex.Message}{Environment.NewLine}{Environment.NewLine}Emulator Variable is:{(string.IsNullOrWhiteSpace(emu) ? "missing":emu)}", "Close");
            }
        }
    }
}
